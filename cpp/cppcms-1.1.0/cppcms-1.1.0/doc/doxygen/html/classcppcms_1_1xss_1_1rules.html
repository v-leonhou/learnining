<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CppCMS: cppcms::xss::rules Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CppCMS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacecppcms.html">cppcms</a></li><li class="navelem"><a class="el" href="namespacecppcms_1_1xss.html">xss</a></li><li class="navelem"><a class="el" href="classcppcms_1_1xss_1_1rules.html">rules</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classcppcms_1_1xss_1_1rules-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">cppcms::xss::rules Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The class that holds XSS filter rules.  
 <a href="classcppcms_1_1xss_1_1rules.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="xss_8h_source.html">cppcms/xss.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a1644c56e2a4307b685dbcfe196203989"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">html_type</a> { <a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989a119fb84ab9d8cfa6faca1251ef49049a">xhtml_input</a>, 
<a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989a1e1f75cb056dedf154b9fb511f69a1fa">html_input</a>
 }</td></tr>
<tr class="separator:a1644c56e2a4307b685dbcfe196203989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69863596dbd7b396531cba9459210837"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837">tag_type</a> { <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837a8df492852dfe684990ba826d906f8385">invalid_tag</a> = 0, 
<a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837a445b77dc48475dbffe83772a61c42f4e">opening_and_closing</a> = 1, 
<a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837ad8e043650cd754041ec67adbda0fe155">stand_alone</a> = 2, 
<a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837a7b09dc31a417c5321682c0b5a99b92bb">any_tag</a> = 3
 }</td></tr>
<tr class="separator:a69863596dbd7b396531cba9459210837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c89d2a52756c854f8aa550b2ddb448"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classbooster_1_1function.html">booster::function</a>&lt; bool(char const *begin, char const *end)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a></td></tr>
<tr class="separator:a69c89d2a52756c854f8aa550b2ddb448"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a47aa2c5d6e9d92ba699cd143ca0f546b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a47aa2c5d6e9d92ba699cd143ca0f546b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>rules</b> (<a class="el" href="classcppcms_1_1xss_1_1rules.html">rules</a> const &amp;)</td></tr>
<tr class="separator:a47aa2c5d6e9d92ba699cd143ca0f546b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a936804c2e90e4392866e2992c4e4c338"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a936804c2e90e4392866e2992c4e4c338"></a>
<a class="el" href="classcppcms_1_1xss_1_1rules.html">rules</a> const &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classcppcms_1_1xss_1_1rules.html">rules</a> const &amp;)</td></tr>
<tr class="separator:a936804c2e90e4392866e2992c4e4c338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c1828768ddd48381a78cb3b14be5190"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a2c1828768ddd48381a78cb3b14be5190">rules</a> (<a class="el" href="classcppcms_1_1json_1_1value.html">json::value</a> const &amp;r)</td></tr>
<tr class="separator:a2c1828768ddd48381a78cb3b14be5190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b47313ec2382e2cc5e21f62432063e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a59b47313ec2382e2cc5e21f62432063e">rules</a> (std::string const &amp;file_name)</td></tr>
<tr class="separator:a59b47313ec2382e2cc5e21f62432063e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd852c3ebfd25bc46e9b367583ae75d5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">html_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#acd852c3ebfd25bc46e9b367583ae75d5">html</a> () const </td></tr>
<tr class="separator:acd852c3ebfd25bc46e9b367583ae75d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcada4a56063c90ccc83b637c4bc3fa3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#afcada4a56063c90ccc83b637c4bc3fa3">html</a> (<a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">html_type</a> t)</td></tr>
<tr class="separator:afcada4a56063c90ccc83b637c4bc3fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2774aa4922de5710747fa13ce459c812"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a2774aa4922de5710747fa13ce459c812">add_tag</a> (std::string const &amp;name, <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837">tag_type</a>=<a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837a7b09dc31a417c5321682c0b5a99b92bb">any_tag</a>)</td></tr>
<tr class="separator:a2774aa4922de5710747fa13ce459c812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c4041a5c4af1fd920e253bce1af3fdf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1c4041a5c4af1fd920e253bce1af3fdf">add_entity</a> (std::string const &amp;name)</td></tr>
<tr class="separator:a1c4041a5c4af1fd920e253bce1af3fdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3860b7d6158aaec81a808a664066d18"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#ab3860b7d6158aaec81a808a664066d18">numeric_entities_allowed</a> () const </td></tr>
<tr class="separator:ab3860b7d6158aaec81a808a664066d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a460042f0b115b0e5831e4ac12dfd0211"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a460042f0b115b0e5831e4ac12dfd0211">numeric_entities_allowed</a> (bool v)</td></tr>
<tr class="separator:a460042f0b115b0e5831e4ac12dfd0211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f5cae3c58d3b2d2e3a17bc283276664"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a8f5cae3c58d3b2d2e3a17bc283276664">add_boolean_property</a> (std::string const &amp;tag_name, std::string const &amp;property)</td></tr>
<tr class="separator:a8f5cae3c58d3b2d2e3a17bc283276664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2099cb2d0c6f838048050f8d1243024b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a2099cb2d0c6f838048050f8d1243024b">add_property</a> (std::string const &amp;tag_name, std::string const &amp;property, <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a> const &amp;val)</td></tr>
<tr class="separator:a2099cb2d0c6f838048050f8d1243024b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4d681f68f5c80b4b2f9b7239c1d243"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1e4d681f68f5c80b4b2f9b7239c1d243">add_property</a> (std::string const &amp;tag_name, std::string const &amp;property, <a class="el" href="classbooster_1_1regex.html">booster::regex</a> const &amp;r)</td></tr>
<tr class="separator:a1e4d681f68f5c80b4b2f9b7239c1d243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86cfeab9bc1b7fe3e54d7dd0247cc652"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a86cfeab9bc1b7fe3e54d7dd0247cc652">add_integer_property</a> (std::string const &amp;tag_name, std::string const &amp;property)</td></tr>
<tr class="separator:a86cfeab9bc1b7fe3e54d7dd0247cc652"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54d7410dc682b3418c0d2f1ffc27bee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#ab54d7410dc682b3418c0d2f1ffc27bee">add_uri_property</a> (std::string const &amp;tag_name, std::string const &amp;property)</td></tr>
<tr class="separator:ab54d7410dc682b3418c0d2f1ffc27bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8f18331c36bb7b1fde736ca88d398b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a9a8f18331c36bb7b1fde736ca88d398b">add_uri_property</a> (std::string const &amp;tag_name, std::string const &amp;property, std::string const &amp;schema)</td></tr>
<tr class="separator:a9a8f18331c36bb7b1fde736ca88d398b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9057cced4353ff9aab2e4b736e397fd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#af9057cced4353ff9aab2e4b736e397fd">comments_allowed</a> () const </td></tr>
<tr class="separator:af9057cced4353ff9aab2e4b736e397fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa42cb719631e8e7f26984b4baa3171"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a2aa42cb719631e8e7f26984b4baa3171">comments_allowed</a> (bool comments)</td></tr>
<tr class="separator:a2aa42cb719631e8e7f26984b4baa3171"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499564d0a55b0e336fd2e4bc4ec9ef69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a499564d0a55b0e336fd2e4bc4ec9ef69">encoding</a> (std::string const &amp;enc)</td></tr>
<tr class="separator:a499564d0a55b0e336fd2e4bc4ec9ef69"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a9ea6960d1aebfbfa6f8f10d6e3544158"><td class="memItemLeft" align="right" valign="top">static CPPCMS_DEPRECATED <a class="el" href="classbooster_1_1regex.html">booster::regex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a9ea6960d1aebfbfa6f8f10d6e3544158">uri_matcher</a> ()</td></tr>
<tr class="separator:a9ea6960d1aebfbfa6f8f10d6e3544158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3d3c3e1f01e7e7025853ca92fd7bb3"><td class="memItemLeft" align="right" valign="top">static CPPCMS_DEPRECATED <a class="el" href="classbooster_1_1regex.html">booster::regex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a5e3d3c3e1f01e7e7025853ca92fd7bb3">uri_matcher</a> (std::string const &amp;schema)</td></tr>
<tr class="separator:a5e3d3c3e1f01e7e7025853ca92fd7bb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3471f62800f650ac9a4a972e466073fe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a3471f62800f650ac9a4a972e466073fe">uri_validator</a> ()</td></tr>
<tr class="separator:a3471f62800f650ac9a4a972e466073fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47581b9c18b9f5ea53de478dd9240590"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a47581b9c18b9f5ea53de478dd9240590">uri_validator</a> (std::string const &amp;scheme, bool absolute_only=false)</td></tr>
<tr class="separator:a47581b9c18b9f5ea53de478dd9240590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9a67c8379b6c143eae60e363ae7ef1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a7b9a67c8379b6c143eae60e363ae7ef1">relative_uri_validator</a> ()</td></tr>
<tr class="separator:a7b9a67c8379b6c143eae60e363ae7ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The class that holds XSS filter rules. </p>
<p>This is the major class the defines the white list rules to handle the Correct HTML input.</p>
<p>When using these rules you should be very strict about what you need and what you allow.</p>
<p>Basically you need to specify:</p>
<ol type="1">
<li>The XHTML or HTML parsing rules - should be done first</li>
<li>The encoding of the text. If you do not specify the encoding it would be assumed that it is ASCII compatible. You may not specify encoding only if you know that it was validated for example by using <a class="el" href="classcppcms_1_1widgets_1_1text.html" title="This class represents an HTML form input element of type text. ">widgets::text</a>, otherwise <b>always</b> specify encoding</li>
<li>Provide the list of tags that should be used. Specify only thous you need. Never allow tags like style, object, embed or of course script as they can be easily used for XSS attacks</li>
<li>Provide essential HTML attributes - properties for tags you need. Use add_uri_property for links like src for img or href for a. It would check correctness of URI syntax and ensure that only white-listed schemas are allowed (i.e. no javascript would be allowed). Never allow style tags unless you specify very strict white list of really used styles. Styles can be easily exploited for both XSS and click-jacking. For example <div class="fragment"><div class="line">&lt;p style=<span class="stringliteral">&quot;width: expression(alert(&#39;XSS&#39;));&quot;</span>&gt;&lt;/p&gt;</div></div><!-- fragment --> If you want to use styles specify very strict list of things you need like: <div class="fragment"><div class="line"><a class="code" href="classcppcms_1_1xss_1_1rules.html#a2099cb2d0c6f838048050f8d1243024b">add_property</a>(<span class="stringliteral">&quot;p&quot;</span>,<span class="stringliteral">&quot;style&quot;</span>,<a class="code" href="classbooster_1_1regex.html">booster::regex</a>(<span class="stringliteral">&quot;text-align:(left|right|center)&quot;</span>));</div></div><!-- fragment --></li>
<li>Do not allow comments unless you need them. Note not all comments are allowed. Comments containing "&lt;", "&gt;" or "&amp;" would be considered invalid as some exploits use them.</li>
</ol>
<p>Remember more strict you are it is harder to make attack. Read about XSS, see existing attacks to understand how they work and then decide what you allow.</p>
<p>rules class can be treated as value for thread safe access, i.e. you can safely use const reference and const member functions as long as you don't change the rules under the hood.</p>
<p>The simplest way: define at application startup some global rules object configure it and use it for filtering and validation - and make your attackers cry :-). </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a69c89d2a52756c854f8aa550b2ddb448"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classbooster_1_1function.html">booster::function</a>&lt;bool(char const *begin,char const *end)&gt; <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">cppcms::xss::rules::validator_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Functor that allows to provide custom validations for different properties </p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="a1644c56e2a4307b685dbcfe196203989"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">cppcms::xss::rules::html_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>How to treat in input </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a1644c56e2a4307b685dbcfe196203989a119fb84ab9d8cfa6faca1251ef49049a"></a>xhtml_input&#160;</td><td class="fielddoc">
<p>Assume that the input is XHTML. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a1644c56e2a4307b685dbcfe196203989a1e1f75cb056dedf154b9fb511f69a1fa"></a>html_input&#160;</td><td class="fielddoc">
<p>Assume that the input is HTML. </p>
</td></tr>
</table>

</div>
</div>
<a class="anchor" id="a69863596dbd7b396531cba9459210837"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837">cppcms::xss::rules::tag_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The type of tag </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a69863596dbd7b396531cba9459210837a8df492852dfe684990ba826d906f8385"></a>invalid_tag&#160;</td><td class="fielddoc">
<p>This tag is invalid (returned by validate) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a69863596dbd7b396531cba9459210837a445b77dc48475dbffe83772a61c42f4e"></a>opening_and_closing&#160;</td><td class="fielddoc">
<p>This tag should be opened and closed like em , or strong. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a69863596dbd7b396531cba9459210837ad8e043650cd754041ec67adbda0fe155"></a>stand_alone&#160;</td><td class="fielddoc">
<p>This tag should stand alone (like hr or br) </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a69863596dbd7b396531cba9459210837a7b09dc31a417c5321682c0b5a99b92bb"></a>any_tag&#160;</td><td class="fielddoc">
<p>This tag can be used in both roles (like input) </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2c1828768ddd48381a78cb3b14be5190"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cppcms::xss::rules::rules </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcppcms_1_1json_1_1value.html">json::value</a> const &amp;&#160;</td>
          <td class="paramname"><em>r</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create rules from JSON object <em>r</em> </p>
<p>The json object the defines the XSS prevention rules. This object has following properties:</p>
<ul>
<li>"xhtml" - boolean; default true - use XHTML (true) or HTML input</li>
<li>"comments" - boolean; setting it to true allows comments, default false</li>
<li>"numeric_entities" - boolean; setting it to true allows numeric_entities, default false</li>
<li>"entities" - array of strings: list of allowed HTML entities besides lt, gt and amp</li>
<li>"encoding" - string; the encoding of the text to validate, by default not checked and the input is assumed to be ASCII compatible. Always specifiy it for multibyte encodings like Shift-JIS or GBK as they are not ASCII compatible.</li>
<li>"tags" - object with 3 properties of type array of string:<ul>
<li>"opening_and_closing" - the tags that should come in pair like "&lt;b&gt;&lt;/b&gt;"</li>
<li>"stand_alone" - the tags that should appear stand alone like "&lt;br/&gt;"</li>
<li>"any_tag" - the tags that can be both like "&lt;input&gt;"</li>
</ul>
</li>
<li>"attributes" - array of objects that define HTML attributes. Each object consists of following properties:<ul>
<li>"type" - string - the type of the attribute one of: "boolean", "uri", "relative_uri", "absolute_uri", "integer", "regex".</li>
<li>"scheme" - string the allowed URI scheme - regular expression like "(http|ftp)". Used with "uri" and "absolute_uri" type</li>
<li>"expression" - string the regular expression that defines the value that the attribute should match.</li>
<li>"tags" - array of strings - list of tags that this attribute is allowed for.</li>
<li>"attributes" - array of strings - lisf of names of the attribute</li>
</ul>
</li>
</ul>
<p>"pairs" - array of objects that consists of two properities "tag" and "attr" of type string that define tag and attributed that such type of property should be allowed for.</p>
<p>The extra properties that are not defined by this scheme are ingored</p>
<p>For example: </p><div class="fragment"><div class="line">{</div><div class="line">        <span class="stringliteral">&quot;xhtml&quot;</span> : <span class="keyword">true</span>,</div><div class="line">        <span class="stringliteral">&quot;encoding&quot;</span> : <span class="stringliteral">&quot;UTF-8&quot;</span>,</div><div class="line">        <span class="stringliteral">&quot;entities&quot;</span> : [ <span class="stringliteral">&quot;nbsp&quot;</span> , <span class="stringliteral">&quot;copy&quot;</span> ],</div><div class="line">        <span class="stringliteral">&quot;comments&quot;</span> : <span class="keyword">false</span>,</div><div class="line">        <span class="stringliteral">&quot;numeric_entities&quot;</span> : <span class="keyword">false</span>,</div><div class="line">        <span class="stringliteral">&quot;tags&quot;</span> : {</div><div class="line">                <span class="stringliteral">&quot;opening_and_closing&quot;</span> : [</div><div class="line">                        <span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;tt&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;a&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;strong&quot;</span>, <span class="stringliteral">&quot;em&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;sub&quot;</span>, <span class="stringliteral">&quot;sup&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;ol&quot;</span>, <span class="stringliteral">&quot;ul&quot;</span>, <span class="stringliteral">&quot;li&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;dd&quot;</span>, <span class="stringliteral">&quot;dt&quot;</span>, <span class="stringliteral">&quot;dl&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;blockquote&quot;</span>,<span class="stringliteral">&quot;code&quot;</span>, <span class="stringliteral">&quot;pre&quot;</span>,</div><div class="line">                <span class="stringliteral">&quot;span&quot;</span>, <span class="stringliteral">&quot;div&quot;</span></div><div class="line">                ],</div><div class="line">                <span class="stringliteral">&quot;stand_alone&quot;</span> : [ <span class="stringliteral">&quot;br&quot;</span>, <span class="stringliteral">&quot;hr&quot;</span>, <span class="stringliteral">&quot;img&quot;</span> ]</div><div class="line">        ],</div><div class="line">        <span class="stringliteral">&quot;attributes&quot;</span>: [</div><div class="line">                {</div><div class="line">                        <span class="stringliteral">&quot;tags&quot;</span> : [ <span class="stringliteral">&quot;p&quot;</span>, <span class="stringliteral">&quot;li&quot;</span>, <span class="stringliteral">&quot;ul&quot;</span> ]</div><div class="line">                        <span class="stringliteral">&quot;attr&quot;</span> : [ <span class="stringliteral">&quot;style&quot;</span> ],</div><div class="line">                        <span class="stringliteral">&quot;type&quot;</span> : <span class="stringliteral">&quot;regex&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;expression&quot;</span> : <span class="stringliteral">&quot;\\s*text-algin:\\s*(center|left|right|justify);?\\s*&quot;</span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                        <span class="stringliteral">&quot;tags&quot;</span> : [ <span class="stringliteral">&quot;span&quot;</span>, <span class="stringliteral">&quot;div&quot;</span> ]</div><div class="line">                        <span class="stringliteral">&quot;attr&quot;</span> : [ <span class="stringliteral">&quot;class&quot;</span>, <span class="stringliteral">&quot;id&quot;</span> ],</div><div class="line">                        <span class="stringliteral">&quot;type&quot;</span> : <span class="stringliteral">&quot;regex&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;expression&quot;</span> : <span class="stringliteral">&quot;[a-zA-Z_0-9]+&quot;</span></div><div class="line">                },</div><div class="line">                {</div><div class="line">                <span class="stringliteral">&quot;pairs&quot;</span> : [ </div><div class="line">                        { <span class="stringliteral">&quot;tag&quot;</span> : <span class="stringliteral">&quot;a&quot;</span>,   <span class="stringliteral">&quot;attr&quot;</span> : <span class="stringliteral">&quot;href&quot;</span> },</div><div class="line">                        { <span class="stringliteral">&quot;tag&quot;</span> : <span class="stringliteral">&quot;img&quot;</span>, <span class="stringliteral">&quot;attr&quot;</span> : <span class="stringliteral">&quot;src&quot;</span>  }</div><div class="line">                ],</div><div class="line">                        <span class="stringliteral">&quot;type&quot;</span> : <span class="stringliteral">&quot;absolute_uri&quot;</span>,</div><div class="line">                        <span class="stringliteral">&quot;scheme&quot;</span> : <span class="stringliteral">&quot;(http|https|ftp)&quot;</span></div><div class="line">                },</div><div class="line">        {</div><div class="line">                <span class="stringliteral">&quot;tags&quot;</span> : [ <span class="stringliteral">&quot;img&quot;</span> ],</div><div class="line">                <span class="stringliteral">&quot;attr&quot;</span> : [ <span class="stringliteral">&quot;alt&quot;</span> ],</div><div class="line">                <span class="stringliteral">&quot;type&quot;</span> : <span class="stringliteral">&quot;regex&quot;</span>,</div><div class="line">                <span class="stringliteral">&quot;expression&quot;</span> : <span class="stringliteral">&quot;.*&quot;</span></div><div class="line">        }</div><div class="line">        ]</div><div class="line">}</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a59b47313ec2382e2cc5e21f62432063e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cppcms::xss::rules::rules </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>file_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create rules from the JSON object stored in the file <em>file_name</em> </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classcppcms_1_1xss_1_1rules.html#a2c1828768ddd48381a78cb3b14be5190">rules(json::value const&amp;)</a> </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a8f5cae3c58d3b2d2e3a17bc283276664"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_boolean_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the property that should be allowed to appear for specific tag as boolean property like checked="checked", when the type is HTML it is case insensitive.</p>
<p>The <em>property</em> should be ASCII only </p>

</div>
</div>
<a class="anchor" id="a1c4041a5c4af1fd920e253bce1af3fdf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_entity </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add allowed HTML entity, by default only "lt", "gt", "quot" and "amp" are allowed </p>

</div>
</div>
<a class="anchor" id="a86cfeab9bc1b7fe3e54d7dd0247cc652"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_integer_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add numeric property, same as add_property(tag_name,property,<a class="el" href="classbooster_1_1regex.html" title="This is a simple wrapper of PCRE library. ">booster::regex</a>("-?[0-9]+") but little bit more efficient </p>

</div>
</div>
<a class="anchor" id="a2099cb2d0c6f838048050f8d1243024b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a> const &amp;&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the property that should be checked using custom functor </p>

</div>
</div>
<a class="anchor" id="a1e4d681f68f5c80b4b2f9b7239c1d243"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbooster_1_1regex.html">booster::regex</a> const &amp;&#160;</td>
          <td class="paramname"><em>r</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the property that should be checked using regular expression. </p>

</div>
</div>
<a class="anchor" id="a2774aa4922de5710747fa13ce459c812"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_tag </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837">tag_type</a>&#160;</td>
          <td class="paramname"> = <code><a class="el" href="classcppcms_1_1xss_1_1rules.html#a69863596dbd7b396531cba9459210837a7b09dc31a417c5321682c0b5a99b92bb">any_tag</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add the tag that should be allowed to appear in the text, for HTML the name is case insensitive, i.e. "br", "Br", "bR" and "BR" are valid tags for name "br".</p>
<p>The <em>name</em> should be ASCII only </p>

</div>
</div>
<a class="anchor" id="ab54d7410dc682b3418c0d2f1ffc27bee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_uri_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add URI property. It should be used for properties like like "href" or "src". It is very good idea to use it in order to prevent urls like javascript:alert('XSS')</p>
<p>It's behavior is same as add_property(tag_name,property,rules::uri_validator()); </p>

</div>
</div>
<a class="anchor" id="a9a8f18331c36bb7b1fde736ca88d398b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::add_uri_property </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>tag_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>property</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>schema</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add URI property, using regular expression that matches allowed schemas. It should be used for properties like like "href" or "src". It is very good idea to use it in order to prevent urls like javascript:alert('XSS')</p>
<p>It's behavior is same as add_property(tag_name,property,rules::uri_validator(schema)); </p>

</div>
</div>
<a class="anchor" id="af9057cced4353ff9aab2e4b736e397fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cppcms::xss::rules::comments_allowed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if the comments are allowed in the text </p>

</div>
</div>
<a class="anchor" id="a2aa42cb719631e8e7f26984b4baa3171"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::comments_allowed </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>comments</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set to true if the comments are allowed in the text </p>

</div>
</div>
<a class="anchor" id="a499564d0a55b0e336fd2e4bc4ec9ef69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::encoding </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>enc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the character encoding of the source, otherwise encoding is not checked and assumed valid all invalid characters are removed from the text or replaced with default character</p>
<p>It is very important to specify this option. You may skip it if you are sure that the the input encoding was already validated using cppcms::form::text widget that handles character encoding validation by default.</p>
<p>In any case it is generally better to always specify this option.</p>
<dl class="section note"><dt>Note</dt><dd>the replace functionality is not supported for all encoding, only UTF-8, ISO-8859-* and single byte windows-12XX encodings support such replacement with default character, for all other encodings like Shift-JIS, the invalid characters or characters that are invalid for use in HTML are removed. </dd></dl>

</div>
</div>
<a class="anchor" id="acd852c3ebfd25bc46e9b367583ae75d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">html_type</a> cppcms::xss::rules::html </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get how to treat input - HTML or XHTML </p>

</div>
</div>
<a class="anchor" id="afcada4a56063c90ccc83b637c4bc3fa3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::html </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classcppcms_1_1xss_1_1rules.html#a1644c56e2a4307b685dbcfe196203989">html_type</a>&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set how to treat input - HTML or XHTML, it should be called first before you add any other rules </p>

</div>
</div>
<a class="anchor" id="ab3860b7d6158aaec81a808a664066d18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool cppcms::xss::rules::numeric_entities_allowed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get if numeric entities are allowed, default is false </p>

</div>
</div>
<a class="anchor" id="a460042f0b115b0e5831e4ac12dfd0211"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cppcms::xss::rules::numeric_entities_allowed </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set if numeric entities are allowed </p>

</div>
</div>
<a class="anchor" id="a7b9a67c8379b6c143eae60e363ae7ef1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a> cppcms::xss::rules::relative_uri_validator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a validator that checks that this URI is relative and it is safe for inclusion in URI property like href or src </p>

</div>
</div>
<a class="anchor" id="a9ea6960d1aebfbfa6f8f10d6e3544158"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static CPPCMS_DEPRECATED <a class="el" href="classbooster_1_1regex.html">booster::regex</a> cppcms::xss::rules::uri_matcher </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>use uri_validator </dd></dl>
<p>Create a regular expression that checks URI for safe inclusion in the property. By default it allows only: http, https, ftp, mailto, news, nntp.</p>
<p>If you need finer control over allowed schemas, use <a class="el" href="classcppcms_1_1xss_1_1rules.html#a5e3d3c3e1f01e7e7025853ca92fd7bb3">uri_matcher(std::string const&amp;)</a>. </p>

</div>
</div>
<a class="anchor" id="a5e3d3c3e1f01e7e7025853ca92fd7bb3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static CPPCMS_DEPRECATED <a class="el" href="classbooster_1_1regex.html">booster::regex</a> cppcms::xss::rules::uri_matcher </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>schema</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>use uri_validator </dd></dl>
<p>Create a regular expression that checks URI for safe inclusion in the text, where schema is a regular expression that matches specific protocols that can be used.</p>
<dl class="section note"><dt>Note</dt><dd>Don't add "^" or "$" tags as this expression would be used in construction of regular other expression.</dd></dl>
<p>For example: </p><div class="fragment"><div class="line"><a class="code" href="classbooster_1_1regex.html">booster::regex</a> uri = <a class="code" href="classcppcms_1_1xss_1_1rules.html#a9ea6960d1aebfbfa6f8f10d6e3544158">uri_matcher</a>(<span class="stringliteral">&quot;(http|https)&quot;</span>);</div></div><!-- fragment --> 
</div>
</div>
<a class="anchor" id="a3471f62800f650ac9a4a972e466073fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a> cppcms::xss::rules::uri_validator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a validator that checks URI for safe inclusion in the property. By default it allows only: http, https, ftp, mailto, news, nntp.</p>
<p>If you need finer control over allowed schemas, use uri_validator(std::string const&amp;). </p>

</div>
</div>
<a class="anchor" id="a47581b9c18b9f5ea53de478dd9240590"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classcppcms_1_1xss_1_1rules.html#a69c89d2a52756c854f8aa550b2ddb448">validator_type</a> cppcms::xss::rules::uri_validator </td>
          <td>(</td>
          <td class="paramtype">std::string const &amp;&#160;</td>
          <td class="paramname"><em>scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>absolute_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Create a validator that checks URI for safe inclusion in the property.</p><ul>
<li>schema is a regular expression that matches specific protocols that can be used.</li>
<li>absolute_only - set to true to prevent accepting relative URIs like "/files/img.png" or "test.html"</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>You don't need to add "^" or "$" tags to <em>scheme</em> </dd></dl>
<p>For example: </p><div class="fragment"><div class="line"><a class="code" href="classcppcms_1_1xss_1_1rules.html#a3471f62800f650ac9a4a972e466073fe">uri_validator</a>(<span class="stringliteral">&quot;(http|https)&quot;</span>);</div></div><!-- fragment --><p>If you need finer control over allowed schemas, use uri_validator(std::string const&amp;). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>cppcms/<a class="el" href="xss_8h_source.html">xss.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jul 11 2017 23:25:57 for CppCMS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
